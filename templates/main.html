<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Късметче</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <nav>
        <ul>
            <li><a href="{% url 'home' %}"><img class="logo-img" src="{% static 'images/logo.png' %}" alt=""></a></li>
            <li><a href="{% url 'home' %}"><i class="fa-sharp fa-solid fa-house"></i></a></li>
            {% if request.user.is_authenticated %}
            <li>
                <p>Credits: <span
                        style="font-weight: bold; font-style: italic;">{{request.user.customer.credits}}</span></p>
            </li>
            <li><a href="{% url 'logout' %}"><i class="fa-solid fa-arrow-right-from-bracket"></i></a></li>
            {% else %}
            <li><a href="{% url 'login' %}">Вход</a></li>
            <li><a href="{% url 'register' %}">Регистрация</a></li>
            {% endif %}
        </ul>
    </nav>
    {% block content %}

    {% endblock content %}

    <script src="{% static 'js/scratch.js' %}"></script>

    <script>

        const div = document.createElement('div')
        div.className = 'bg'
        document.body.appendChild(div)

    </script>

    <script>

        async function reset_at_midnight(){
            url = '/reset_at_midnight/'
            await fetch(url)
        }

        function resetAtMidnight() {
            var now = new Date();
            var night = new Date(
                now.getFullYear(),
                now.getMonth(),
                now.getDate() + 1, // the next day, ...
                0, 0, 0 // ...at 00:00:00 hours
            );
            var msToMidnight = night.getTime() - now.getTime();

            setTimeout(function () {
                reset_at_midnight()            //      <-- This is the function being called at midnight.
                resetAtMidnight()  //      Then, reset again next midnight.
            }, msToMidnight);
        }
        resetAtMidnight()
    </script>

</body>

</html>